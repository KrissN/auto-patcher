diff -Npruw stock-services/smali/com/android/server/am/BroadcastQueue.smali pdroid-services/smali/com/android/server/am/BroadcastQueue.smali
--- stock-services/smali/com/android/server/am/BroadcastQueue.smali	2014-05-19 12:43:47.521120601 +0200
+++ pdroid-services/smali/com/android/server/am/BroadcastQueue.smali	2014-05-19 12:43:52.820100112 +0200
@@ -804,6 +804,120 @@
     goto :goto_1d1
 .end method
 
+.method private enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+    .registers 10
+    .param p1    # Ljava/lang/Object;
+    .param p2    # Lcom/android/server/am/BroadcastRecord;
+
+    if-eqz p2, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v4}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v4
+
+    if-eqz v4, :cond_3b
+
+    const/4 v2, 0x0
+
+    const/4 v3, -0x1
+
+    :try_start_10
+    instance-of v4, p1, Lcom/android/server/am/BroadcastFilter;
+
+    if-eqz v4, :cond_3c
+
+    move-object v0, p1
+
+    check-cast v0, Lcom/android/server/am/BroadcastFilter;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Lcom/android/server/am/BroadcastFilter;
+
+    iget-object v4, p1, Lcom/android/server/am/BroadcastFilter;->receiverList:Lcom/android/server/am/ReceiverList;
+
+    iget-object v4, v4, Lcom/android/server/am/ReceiverList;->app:Lcom/android/server/am/ProcessRecord;
+
+    iget-object v4, v4, Lcom/android/server/am/ProcessRecord;->info:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_2a
+    .catch Ljava/lang/Exception; {:try_start_10 .. :try_end_2a} :catch_53
+
+    :cond_2a
+    :goto_2a
+    if-eqz v2, :cond_3b
+
+    const/4 v4, -0x1
+
+    if-eq v3, v4, :cond_3b
+
+    iget-object v4, p2, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const/4 v5, 0x0
+
+    iget-object v6, p2, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
+
+    invoke-interface {v6}, Ljava/util/List;->size()I
+
+    move-result v6
+
+    invoke-static {v2, v3, v4, v5, v6}, Landroid/privacy/surrogate/PrivacyActivityManagerService;->enforcePrivacyPermission(Ljava/lang/String;ILandroid/content/Intent;Landroid/content/Context;I)V
+
+    :cond_3b
+    :goto_3b
+    return-void
+
+    :cond_3c
+    :try_start_3c
+    instance-of v4, p1, Landroid/content/pm/ResolveInfo;
+
+    if-eqz v4, :cond_2a
+
+    move-object v0, p1
+
+    check-cast v0, Landroid/content/pm/ResolveInfo;
+
+    move-object v4, v0
+
+    iget-object v4, v4, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget-object v2, v4, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
+
+    check-cast p1, Landroid/content/pm/ResolveInfo;
+
+    iget-object v4, p1, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
+
+    iget-object v4, v4, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
+
+    iget v3, v4, Landroid/content/pm/ApplicationInfo;->uid:I
+    :try_end_52
+    .catch Ljava/lang/Exception; {:try_start_3c .. :try_end_52} :catch_53
+
+    goto :goto_2a
+
+    :catch_53
+    move-exception v1
+
+    goto :goto_3b
+.end method
+
 .method private getWhiteList()Ljava/util/ArrayList;
     .registers 3
     .annotation system Ldalvik/annotation/Signature;
@@ -2862,16 +2976,16 @@
 .end method
 
 .method final processNextBroadcast(Z)V
-    .registers 41
+    .registers 42
     .param p1    # Z
 
     move-object/from16 v0, p0
 
     iget-object v0, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v38, v0
+    move-object/from16 v39, v0
 
-    monitor-enter v38
+    monitor-enter v39
 
     :try_start_7
     move-object/from16 v0, p0
@@ -2908,15 +3022,15 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->remove(I)Ljava/lang/Object;
 
-    move-result-object v32
+    move-result-object v33
 
-    check-cast v32, Lcom/android/server/am/BroadcastRecord;
+    check-cast v33, Lcom/android/server/am/BroadcastRecord;
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
     move-result-wide v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -2924,17 +3038,17 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
@@ -2942,43 +3056,43 @@
 
     move-result v13
 
-    const/16 v19, 0x0
+    const/16 v20, 0x0
 
     :goto_4a
-    move/from16 v0, v19
+    move/from16 v0, v20
 
     if-ge v0, v13, :cond_67
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v19
+    move/from16 v0, v20
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v35
+    move-result-object v36
 
-    check-cast v35, Lcom/android/server/am/BroadcastFilter;
+    check-cast v36, Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
-    move-object/from16 v2, v35
+    move-object/from16 v2, v36
 
     invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
 
-    add-int/lit8 v19, v19, 0x1
+    add-int/lit8 v20, v20, 0x1
 
     goto :goto_4a
 
     :cond_67
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -2993,7 +3107,7 @@
     :catchall_74
     move-exception v3
 
-    monitor-exit v38
+    monitor-exit v39
     :try_end_76
     .catchall {:try_start_7 .. :try_end_76} :catchall_74
 
@@ -3034,30 +3148,30 @@
 
     invoke-virtual {v3, v6}, Landroid/util/SparseArray;->get(I)Ljava/lang/Object;
 
-    move-result-object v31
+    move-result-object v32
 
-    check-cast v31, Lcom/android/server/am/ProcessRecord;
+    check-cast v32, Lcom/android/server/am/ProcessRecord;
 
-    if-eqz v31, :cond_a0
+    if-eqz v32, :cond_a0
 
-    move-object/from16 v0, v31
+    move-object/from16 v0, v32
 
     iget-boolean v3, v0, Lcom/android/server/am/ProcessRecord;->crashing:Z
 
     if-eqz v3, :cond_a7
 
     :cond_a0
-    const/16 v22, 0x1
+    const/16 v23, 0x1
 
     :goto_a2
     monitor-exit v5
     :try_end_a3
     .catchall {:try_start_84 .. :try_end_a3} :catchall_aa
 
-    if-nez v22, :cond_ad
+    if-nez v23, :cond_ad
 
     :try_start_a5
-    monitor-exit v38
+    monitor-exit v39
     :try_end_a6
     .catchall {:try_start_a5 .. :try_end_a6} :catchall_74
 
@@ -3065,7 +3179,7 @@
     return-void
 
     :cond_a7
-    const/16 v22, 0x0
+    const/16 v23, 0x0
 
     goto :goto_a2
 
@@ -3154,7 +3268,7 @@
     iput-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
     :cond_f5
-    const/16 v24, 0x0
+    const/16 v25, 0x0
 
     :cond_f7
     move-object/from16 v0, p0
@@ -3173,7 +3287,7 @@
 
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->scheduleAppGcsLocked()V
 
-    if-eqz v24, :cond_111
+    if-eqz v25, :cond_111
 
     move-object/from16 v0, p0
 
@@ -3182,7 +3296,7 @@
     invoke-virtual {v3}, Lcom/android/server/am/ActivityManagerService;->updateOomAdjLocked()V
 
     :cond_111
-    monitor-exit v38
+    monitor-exit v39
 
     goto :goto_a6
 
@@ -3195,31 +3309,31 @@
 
     invoke-virtual {v3, v5}, Ljava/util/ArrayList;->get(I)Ljava/lang/Object;
 
-    move-result-object v32
+    move-result-object v33
 
-    check-cast v32, Lcom/android/server/am/BroadcastRecord;
+    check-cast v33, Lcom/android/server/am/BroadcastRecord;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    const/16 v18, 0x0
+    const/16 v19, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_1f6
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     invoke-interface {v3}, Ljava/util/List;->size()I
 
-    move-result v29
+    move-result v30
 
     :goto_134
     move-object/from16 v0, p0
@@ -3230,7 +3344,7 @@
 
     if-eqz v3, :cond_1ed
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -3242,11 +3356,11 @@
 
     invoke-static {}, Landroid/os/SystemClock;->uptimeMillis()J
 
-    move-result-wide v27
+    move-result-wide v28
 
-    if-lez v29, :cond_1ed
+    if-lez v30, :cond_1ed
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -3258,7 +3372,7 @@
 
     mul-long/2addr v7, v9
 
-    move/from16 v0, v29
+    move/from16 v0, v30
 
     int-to-long v9, v0
 
@@ -3266,7 +3380,7 @@
 
     add-long/2addr v5, v7
 
-    cmp-long v3, v27, v5
+    cmp-long v3, v28, v5
 
     if-lez v3, :cond_1ed
 
@@ -3302,7 +3416,7 @@
 
     move-result-object v5
 
-    move-wide/from16 v0, v27
+    move-wide/from16 v0, v28
 
     invoke-virtual {v5, v0, v1}, Ljava/lang/StringBuilder;->append(J)Ljava/lang/StringBuilder;
 
@@ -3314,7 +3428,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -3328,7 +3442,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v6, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -3342,7 +3456,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3356,7 +3470,7 @@
 
     move-result-object v5
 
-    move/from16 v0, v29
+    move/from16 v0, v30
 
     invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(I)Ljava/lang/StringBuilder;
 
@@ -3368,7 +3482,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -3382,7 +3496,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
@@ -3402,55 +3516,55 @@
 
     invoke-virtual {v0, v3}, Lcom/android/server/am/BroadcastQueue;->broadcastTimeoutLocked(Z)V
 
-    const/16 v18, 0x1
+    const/16 v19, 0x1
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     :cond_1ed
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     if-eqz v3, :cond_1fa
 
-    monitor-exit v38
+    monitor-exit v39
 
     goto/16 :goto_a6
 
     :cond_1f6
-    const/16 v29, 0x0
+    const/16 v30, 0x0
 
     goto/16 :goto_134
 
     :cond_1fa
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
     if-eqz v3, :cond_210
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v0, v29
+    move/from16 v0, v30
 
     if-ge v3, v0, :cond_210
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
     if-nez v3, :cond_210
 
-    if-eqz v18, :cond_25c
+    if-eqz v19, :cond_25c
 
     :cond_210
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_214
@@ -3459,31 +3573,31 @@
     if-eqz v3, :cond_241
 
     :try_start_216
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->callerApp:Lcom/android/server/am/ProcessRecord;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v4, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
 
     new-instance v5, Landroid/content/Intent;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
     invoke-direct {v5, v6}, Landroid/content/Intent;-><init>(Landroid/content/Intent;)V
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
@@ -3491,7 +3605,7 @@
 
     const/4 v10, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v11, v0, Lcom/android/server/am/BroadcastRecord;->userId:I
 
@@ -3499,11 +3613,11 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->resultTo:Landroid/content/IIntentReceiver;
     :try_end_241
-    .catch Landroid/os/RemoteException; {:try_start_216 .. :try_end_241} :catch_2d5
+    .catch Landroid/os/RemoteException; {:try_start_216 .. :try_end_241} :catch_306
     .catchall {:try_start_216 .. :try_end_241} :catchall_74
 
     :cond_241
@@ -3513,7 +3627,7 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
     invoke-direct {v0, v1}, Lcom/android/server/am/BroadcastQueue;->addBroadcastToHistoryLocked(Lcom/android/server/am/BroadcastRecord;)V
 
@@ -3531,22 +3645,22 @@
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mCurrentBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    const/16 v32, 0x0
+    const/16 v33, 0x0
 
-    const/16 v24, 0x1
+    const/16 v25, 0x1
 
     :cond_25c
-    if-eqz v32, :cond_f7
+    if-eqz v33, :cond_f7
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v0, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
-    move/from16 v33, v0
+    move/from16 v34, v0
 
-    add-int/lit8 v3, v33, 0x1
+    add-int/lit8 v3, v34, 0x1
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->nextReceiver:I
 
@@ -3554,17 +3668,17 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    if-nez v33, :cond_284
+    if-nez v34, :cond_284
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchTime:J
 
@@ -3572,7 +3686,7 @@
 
     move-result-wide v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->dispatchClockTime:J
 
@@ -3583,7 +3697,7 @@
 
     if-nez v3, :cond_29b
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-wide v5, v0, Lcom/android/server/am/BroadcastRecord;->receiverTime:J
 
@@ -3591,76 +3705,126 @@
 
     iget-wide v7, v0, Lcom/android/server/am/BroadcastQueue;->mTimeoutPeriod:J
 
-    add-long v36, v5, v7
+    add-long v37, v5, v7
 
     move-object/from16 v0, p0
 
-    move-wide/from16 v1, v36
+    move-wide/from16 v1, v37
 
     invoke-virtual {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->setBroadcastTimeoutLocked(J)V
 
     :cond_29b
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receivers:Ljava/util/List;
 
-    move/from16 v0, v33
+    move/from16 v0, v34
 
     invoke-interface {v3, v0}, Ljava/util/List;->get(I)Ljava/lang/Object;
 
-    move-result-object v26
+    move-result-object v27
+
+    move-object/from16 v0, p0
+
+    move-object/from16 v1, v27
+
+    move-object/from16 v2, v33
+
+    invoke-direct {v0, v1, v2}, Lcom/android/server/am/BroadcastQueue;->enforcePrivacyPermission(Ljava/lang/Object;Lcom/android/server/am/BroadcastRecord;)V
+
+    const/16 v17, 0x0
+
+    if-eqz v33, :cond_2d4
+
+    move-object/from16 v0, v33
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    if-eqz v3, :cond_2d4
+
+    move-object/from16 v0, v33
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    if-eqz v3, :cond_2d4
 
-    move-object/from16 v0, v26
+    move-object/from16 v0, v33
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    invoke-virtual {v3}, Landroid/content/Intent;->getAction()Ljava/lang/String;
+
+    move-result-object v3
+
+    const-string v5, "catchBootComplete"
+
+    invoke-virtual {v3, v5}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v3
+
+    if-eqz v3, :cond_2d4
+
+    const/16 v17, 0x1
+
+    :cond_2d4
+    move-object/from16 v0, v27
 
     instance-of v3, v0, Lcom/android/server/am/BroadcastFilter;
 
-    if-eqz v3, :cond_304
+    if-eqz v3, :cond_349
 
-    move-object/from16 v0, v26
+    move-object/from16 v0, v27
 
     check-cast v0, Lcom/android/server/am/BroadcastFilter;
 
-    move-object/from16 v17, v0
+    move-object/from16 v18, v0
 
-    move-object/from16 v0, v32
+    if-nez v17, :cond_335
+
+    move-object/from16 v0, v33
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
-    move-object/from16 v2, v17
+    move-object/from16 v2, v18
 
     invoke-direct {v0, v1, v2, v3}, Lcom/android/server/am/BroadcastQueue;->deliverToRegisteredReceiverLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/BroadcastFilter;Z)V
 
-    move-object/from16 v0, v32
+    :goto_2ef
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
-    if-eqz v3, :cond_2ca
+    if-eqz v3, :cond_2fb
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-boolean v3, v0, Lcom/android/server/am/BroadcastRecord;->ordered:Z
 
-    if-nez v3, :cond_2d2
+    if-nez v3, :cond_303
 
-    :cond_2ca
+    :cond_2fb
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    :cond_2d2
-    monitor-exit v38
+    :cond_303
+    monitor-exit v39
 
     goto/16 :goto_a6
 
-    :catch_2d5
+    :catch_306
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -3689,7 +3853,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3707,16 +3871,39 @@
 
     goto/16 :goto_241
 
-    :cond_304
-    move-object/from16 v0, v26
+    :cond_335
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v33
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
+
+    const/4 v3, 0x0
+
+    move-object/from16 v0, v33
+
+    iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
+
+    move-object/from16 v0, v33
+
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
+
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
+
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
+
+    goto :goto_2ef
+
+    :cond_349
+    move-object/from16 v0, v27
 
     check-cast v0, Landroid/content/pm/ResolveInfo;
 
-    move-object/from16 v20, v0
+    move-object/from16 v21, v0
 
     new-instance v15, Landroid/content/ComponentName;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3724,7 +3911,7 @@
 
     iget-object v3, v3, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3732,27 +3919,27 @@
 
     invoke-direct {v15, v3, v5}, Landroid/content/ComponentName;-><init>(Ljava/lang/String;Ljava/lang/String;)V
 
-    const/16 v34, 0x0
+    const/16 v35, 0x0
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v4, v5, Landroid/content/pm/ActivityInfo;->permission:Ljava/lang/String;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3760,7 +3947,7 @@
 
     iget v7, v7, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3768,17 +3955,17 @@
 
     invoke-virtual/range {v3 .. v8}, Lcom/android/server/am/ActivityManagerService;->checkComponentPermission(Ljava/lang/String;IIIZ)I
 
-    move-result v30
+    move-result v31
 
-    if-eqz v30, :cond_3bf
+    if-eqz v31, :cond_404
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-boolean v3, v3, Landroid/content/pm/ActivityInfo;->exported:Z
 
-    if-nez v3, :cond_57e
+    if-nez v3, :cond_5d0
 
     const-string v3, "BroadcastQueue"
 
@@ -3792,7 +3979,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3810,7 +3997,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -3824,7 +4011,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -3838,7 +4025,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -3858,7 +4045,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3890,11 +4077,11 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    :goto_3bd
-    const/16 v34, 0x1
+    :goto_402
+    const/16 v35, 0x1
 
-    :cond_3bf
-    move-object/from16 v0, v20
+    :cond_404
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3904,26 +4091,26 @@
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_443
+    if-eq v3, v5, :cond_488
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
-    :try_end_3cf
-    .catchall {:try_start_241 .. :try_end_3cf} :catchall_74
+    :try_end_414
+    .catchall {:try_start_241 .. :try_end_414} :catchall_74
 
-    if-eqz v3, :cond_443
+    if-eqz v3, :cond_488
 
-    :try_start_3d1
+    :try_start_416
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -3932,16 +4119,16 @@
     iget-object v6, v6, Landroid/content/pm/ApplicationInfo;->packageName:Ljava/lang/String;
 
     invoke-interface {v3, v5, v6}, Landroid/content/pm/IPackageManager;->checkPermission(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_3e4
-    .catch Landroid/os/RemoteException; {:try_start_3d1 .. :try_end_3e4} :catch_5ee
-    .catchall {:try_start_3d1 .. :try_end_3e4} :catchall_74
+    :try_end_429
+    .catch Landroid/os/RemoteException; {:try_start_416 .. :try_end_429} :catch_640
+    .catchall {:try_start_416 .. :try_end_429} :catchall_74
 
-    move-result v30
+    move-result v31
 
-    :goto_3e5
-    if-eqz v30, :cond_443
+    :goto_42a
+    if-eqz v31, :cond_488
 
-    :try_start_3e7
+    :try_start_42c
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -3954,7 +4141,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -3982,7 +4169,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->requiredPermission:Ljava/lang/String;
 
@@ -3996,7 +4183,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -4010,7 +4197,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -4030,16 +4217,16 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    :cond_443
-    move-object/from16 v0, v32
+    :cond_488
+    move-object/from16 v0, v33
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->appOp:I
 
     const/4 v5, -0x1
 
-    if-eq v3, v5, :cond_46a
+    if-eq v3, v5, :cond_4af
 
     move-object/from16 v0, p0
 
@@ -4047,11 +4234,11 @@
 
     iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mAppOpsService:Lcom/android/server/AppOpsService;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->appOp:I
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4059,7 +4246,7 @@
 
     iget v6, v6, Landroid/content/pm/ApplicationInfo;->uid:I
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4067,14 +4254,14 @@
 
     invoke-virtual {v3, v5, v6, v7}, Lcom/android/server/AppOpsService;->checkOperation(IILjava/lang/String;)I
 
-    move-result v25
+    move-result v26
 
-    if-eqz v25, :cond_46a
+    if-eqz v26, :cond_4af
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    :cond_46a
-    if-nez v34, :cond_492
+    :cond_4af
+    if-nez v35, :cond_4d7
 
     move-object/from16 v0, p0
 
@@ -4082,23 +4269,23 @@
 
     iget-object v3, v3, Lcom/android/server/am/ActivityManagerService;->mIntentFirewall:Lcom/android/server/firewall/IntentFirewall;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v4, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resolvedType:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4107,58 +4294,58 @@
     iget v8, v8, Landroid/content/pm/ApplicationInfo;->uid:I
 
     invoke-virtual/range {v3 .. v8}, Lcom/android/server/firewall/IntentFirewall;->checkBroadcast(Landroid/content/Intent;IILjava/lang/String;I)Z
-    :try_end_48d
-    .catchall {:try_start_3e7 .. :try_end_48d} :catchall_74
+    :try_end_4d2
+    .catchall {:try_start_42c .. :try_end_4d2} :catchall_74
 
     move-result v3
 
-    if-nez v3, :cond_5f3
+    if-nez v3, :cond_645
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    :cond_492
-    :goto_492
-    const/16 v23, 0x0
+    :cond_4d7
+    :goto_4d7
+    const/16 v24, 0x0
 
-    :try_start_494
+    :try_start_4d9
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v5, v5, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v6, v6, Landroid/content/pm/ActivityInfo;->applicationInfo:Landroid/content/pm/ApplicationInfo;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v7, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v7, v7, Landroid/content/pm/ActivityInfo;->name:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v8, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget v8, v8, Landroid/content/pm/ActivityInfo;->flags:I
 
     invoke-virtual {v3, v5, v6, v7, v8}, Lcom/android/server/am/ActivityManagerService;->isSingleton(Ljava/lang/String;Landroid/content/pm/ApplicationInfo;Ljava/lang/String;I)Z
-    :try_end_4b3
-    .catch Ljava/lang/SecurityException; {:try_start_494 .. :try_end_4b3} :catch_5f7
-    .catchall {:try_start_494 .. :try_end_4b3} :catchall_74
-
-    move-result v23
-
-    :goto_4b4
-    :try_start_4b4
-    move-object/from16 v0, v20
+    :try_end_4f8
+    .catch Ljava/lang/SecurityException; {:try_start_4d9 .. :try_end_4f8} :catch_649
+    .catchall {:try_start_4d9 .. :try_end_4f8} :catchall_74
+
+    move-result v24
+
+    :goto_4f9
+    :try_start_4f9
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4168,11 +4355,11 @@
 
     and-int/2addr v3, v5
 
-    if-eqz v3, :cond_4f9
+    if-eqz v3, :cond_53e
 
     const-string v3, "android.permission.INTERACT_ACROSS_USERS"
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4184,7 +4371,7 @@
 
     move-result v3
 
-    if-eqz v3, :cond_4f9
+    if-eqz v3, :cond_53e
 
     const-string v3, "BroadcastQueue"
 
@@ -4224,22 +4411,22 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    :cond_4f9
-    move-object/from16 v0, v32
+    :cond_53e
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-eqz v3, :cond_545
+    if-eqz v3, :cond_58a
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
     iget-boolean v3, v3, Lcom/android/server/am/ProcessRecord;->crashing:Z
 
-    if-eqz v3, :cond_545
+    if-eqz v3, :cond_58a
 
     const-string v3, "BroadcastQueue"
 
@@ -4267,7 +4454,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     invoke-virtual {v5, v0}, Ljava/lang/StringBuilder;->append(Ljava/lang/Object;)Ljava/lang/StringBuilder;
 
@@ -4279,7 +4466,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
@@ -4298,28 +4485,28 @@
     move-result-object v5
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
-    :try_end_543
-    .catchall {:try_start_4b4 .. :try_end_543} :catchall_74
+    :try_end_588
+    .catchall {:try_start_4f9 .. :try_end_588} :catchall_74
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    :cond_545
-    if-nez v34, :cond_567
+    :cond_58a
+    if-nez v35, :cond_5ac
 
-    const/16 v21, 0x0
+    const/16 v22, 0x0
 
-    :try_start_549
+    :try_start_58e
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v5, v5, Landroid/content/pm/ActivityInfo;->packageName:Ljava/lang/String;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4332,46 +4519,59 @@
     move-result v6
 
     invoke-interface {v3, v5, v6}, Landroid/content/pm/IPackageManager;->isPackageAvailable(Ljava/lang/String;I)Z
-    :try_end_562
-    .catch Ljava/lang/Exception; {:try_start_549 .. :try_end_562} :catch_605
-    .catchall {:try_start_549 .. :try_end_562} :catchall_74
+    :try_end_5a7
+    .catch Ljava/lang/Exception; {:try_start_58e .. :try_end_5a7} :catch_657
+    .catchall {:try_start_58e .. :try_end_5a7} :catchall_74
+
+    move-result v22
+
+    :goto_5a8
+    if-nez v22, :cond_5ac
+
+    const/16 v35, 0x1
+
+    :cond_5ac
+    if-eqz v17, :cond_5b9
 
-    move-result v21
+    const/16 v35, 0x1
 
-    :goto_563
-    if-nez v21, :cond_567
+    :try_start_5b0
+    move-object/from16 v0, v33
 
-    const/16 v34, 0x1
+    iget-object v3, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
-    :cond_567
-    if-eqz v34, :cond_628
+    const-string v5, "android.intent.action.BOOT_COMPLETED"
+
+    invoke-virtual {v3, v5}, Landroid/content/Intent;->setAction(Ljava/lang/String;)Landroid/content/Intent;
+
+    :cond_5b9
+    if-eqz v35, :cond_67a
 
     const/4 v3, 0x0
 
-    :try_start_56a
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->receiver:Landroid/os/IBinder;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curFilter:Lcom/android/server/am/BroadcastFilter;
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
     invoke-virtual/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->scheduleBroadcastsLocked()V
 
-    monitor-exit v38
+    monitor-exit v39
 
     goto/16 :goto_a6
 
-    :cond_57e
+    :cond_5d0
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -4384,7 +4584,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4402,7 +4602,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->callerPackage:Ljava/lang/String;
 
@@ -4416,7 +4616,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingPid:I
 
@@ -4430,7 +4630,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v6, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -4450,7 +4650,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4480,21 +4680,21 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto/16 :goto_3bd
+    goto/16 :goto_402
 
-    :catch_5ee
+    :catch_640
     move-exception v16
 
-    const/16 v30, -0x1
+    const/16 v31, -0x1
 
-    goto/16 :goto_3e5
+    goto/16 :goto_42a
 
-    :cond_5f3
-    const/16 v34, 0x0
+    :cond_645
+    const/16 v35, 0x0
 
-    goto/16 :goto_492
+    goto/16 :goto_4d7
 
-    :catch_5f7
+    :catch_649
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -4505,11 +4705,11 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    const/16 v34, 0x1
+    const/16 v35, 0x1
 
-    goto/16 :goto_4b4
+    goto/16 :goto_4f9
 
-    :catch_605
+    :catch_657
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -4524,7 +4724,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4542,40 +4742,40 @@
 
     invoke-static {v3, v5, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    goto/16 :goto_563
+    goto/16 :goto_5a8
 
-    :cond_628
+    :cond_67a
     const/4 v3, 0x1
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
     iget-object v4, v3, Landroid/content/pm/ActivityInfo;->processName:Ljava/lang/String;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v15, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v3, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
     const/16 v5, 0x3e8
 
-    if-eq v3, v5, :cond_652
+    if-eq v3, v5, :cond_6a4
 
-    if-eqz v23, :cond_652
+    if-eqz v24, :cond_6a4
 
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4585,27 +4785,27 @@
 
     move-result-object v3
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iput-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    :cond_652
-    move-object/from16 v0, v20
+    :cond_6a4
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curReceiver:Landroid/content/pm/ActivityInfo;
-    :try_end_65a
-    .catchall {:try_start_56a .. :try_end_65a} :catchall_74
+    :try_end_6ac
+    .catchall {:try_start_5b0 .. :try_end_6ac} :catchall_74
 
-    :try_start_65a
+    :try_start_6ac
     invoke-static {}, Landroid/app/AppGlobals;->getPackageManager()Landroid/content/pm/IPackageManager;
 
     move-result-object v3
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v5, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -4615,7 +4815,7 @@
 
     const/4 v6, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->callingUid:I
 
@@ -4624,18 +4824,18 @@
     move-result v7
 
     invoke-interface {v3, v5, v6, v7}, Landroid/content/pm/IPackageManager;->setPackageStoppedState(Ljava/lang/String;ZI)V
-    :try_end_672
-    .catch Landroid/os/RemoteException; {:try_start_65a .. :try_end_672} :catch_822
-    .catch Ljava/lang/IllegalArgumentException; {:try_start_65a .. :try_end_672} :catch_6a2
-    .catchall {:try_start_65a .. :try_end_672} :catchall_74
+    :try_end_6c4
+    .catch Landroid/os/RemoteException; {:try_start_6ac .. :try_end_6c4} :catch_874
+    .catch Ljava/lang/IllegalArgumentException; {:try_start_6ac .. :try_end_6c4} :catch_6f4
+    .catchall {:try_start_6ac .. :try_end_6c4} :catchall_74
 
-    :goto_672
-    :try_start_672
+    :goto_6c4
+    :try_start_6c4
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4649,16 +4849,16 @@
 
     move-result-object v14
 
-    if-eqz v14, :cond_6ef
+    if-eqz v14, :cond_741
 
     iget-object v3, v14, Lcom/android/server/am/ProcessRecord;->thread:Landroid/app/IApplicationThread;
-    :try_end_687
-    .catchall {:try_start_672 .. :try_end_687} :catchall_74
+    :try_end_6d9
+    .catchall {:try_start_6c4 .. :try_end_6d9} :catchall_74
 
-    if-eqz v3, :cond_6ef
+    if-eqz v3, :cond_741
 
-    :try_start_689
-    move-object/from16 v0, v20
+    :try_start_6db
+    move-object/from16 v0, v21
 
     iget-object v3, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4674,20 +4874,20 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
     invoke-direct {v0, v1, v14}, Lcom/android/server/am/BroadcastQueue;->processCurBroadcastLocked(Lcom/android/server/am/BroadcastRecord;Lcom/android/server/am/ProcessRecord;)V
-    :try_end_69f
-    .catch Landroid/os/RemoteException; {:try_start_689 .. :try_end_69f} :catch_6d0
-    .catch Ljava/lang/RuntimeException; {:try_start_689 .. :try_end_69f} :catch_7b9
-    .catchall {:try_start_689 .. :try_end_69f} :catchall_74
+    :try_end_6f1
+    .catch Landroid/os/RemoteException; {:try_start_6db .. :try_end_6f1} :catch_722
+    .catch Ljava/lang/RuntimeException; {:try_start_6db .. :try_end_6f1} :catch_80b
+    .catchall {:try_start_6db .. :try_end_6f1} :catchall_74
 
-    :try_start_69f
-    monitor-exit v38
+    :try_start_6f1
+    monitor-exit v39
 
     goto/16 :goto_a6
 
-    :catch_6a2
+    :catch_6f4
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -4702,7 +4902,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -4732,9 +4932,9 @@
 
     invoke-static {v3, v5}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;)I
 
-    goto :goto_672
+    goto :goto_6c4
 
-    :catch_6d0
+    :catch_722
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -4749,7 +4949,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -4765,7 +4965,7 @@
 
     invoke-static {v3, v5, v0}, Landroid/util/Slog;->w(Ljava/lang/String;Ljava/lang/String;Ljava/lang/Throwable;)I
 
-    :cond_6ef
+    :cond_741
     const-string v3, "sys.quickboot.enable"
 
     const/4 v5, 0x0
@@ -4776,7 +4976,7 @@
 
     const/4 v5, 0x1
 
-    if-ne v3, v5, :cond_714
+    if-ne v3, v5, :cond_766
 
     const-string v3, "sys.quickboot.poweron"
 
@@ -4786,13 +4986,13 @@
 
     move-result v3
 
-    if-nez v3, :cond_714
+    if-nez v3, :cond_766
 
     invoke-direct/range {p0 .. p0}, Lcom/android/server/am/BroadcastQueue;->getWhiteList()Ljava/util/ArrayList;
 
     move-result-object v3
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4804,14 +5004,14 @@
 
     move-result v3
 
-    if-eqz v3, :cond_749
+    if-eqz v3, :cond_79b
 
-    :cond_714
+    :cond_766
     move-object/from16 v0, p0
 
     iget-object v3, v0, Lcom/android/server/am/BroadcastQueue;->mService:Lcom/android/server/am/ActivityManagerService;
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v5, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4819,7 +5019,7 @@
 
     const/4 v6, 0x1
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4831,11 +5031,11 @@
 
     const-string v8, "broadcast"
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v10, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4847,11 +5047,11 @@
 
     and-int/2addr v10, v11
 
-    if-eqz v10, :cond_810
+    if-eqz v10, :cond_862
 
     const/4 v10, 0x1
 
-    :goto_73d
+    :goto_78f
     const/4 v11, 0x0
 
     const/4 v12, 0x0
@@ -4860,13 +5060,13 @@
 
     move-result-object v3
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput-object v3, v0, Lcom/android/server/am/BroadcastRecord;->curApp:Lcom/android/server/am/ProcessRecord;
 
-    if-nez v3, :cond_813
+    if-nez v3, :cond_865
 
-    :cond_749
+    :cond_79b
     const-string v3, "BroadcastQueue"
 
     new-instance v5, Ljava/lang/StringBuilder;
@@ -4879,7 +5079,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4897,7 +5097,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v20
+    move-object/from16 v0, v21
 
     iget-object v6, v0, Landroid/content/pm/ResolveInfo;->activityInfo:Landroid/content/pm/ActivityInfo;
 
@@ -4915,7 +5115,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -4937,23 +5137,23 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
     invoke-virtual {v0, v1}, Lcom/android/server/am/BroadcastQueue;->logBroadcastReceiverDiscardLocked(Lcom/android/server/am/BroadcastRecord;)V
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v7, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v8, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v9, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-boolean v10, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
@@ -4961,7 +5161,7 @@
 
     move-object/from16 v5, p0
 
-    move-object/from16 v6, v32
+    move-object/from16 v6, v33
 
     invoke-virtual/range {v5 .. v11}, Lcom/android/server/am/BroadcastQueue;->finishReceiverLocked(Lcom/android/server/am/BroadcastRecord;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
 
@@ -4969,15 +5169,15 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    monitor-exit v38
+    monitor-exit v39
 
     goto/16 :goto_a6
 
-    :catch_7b9
+    :catch_80b
     move-exception v16
 
     const-string v3, "BroadcastQueue"
@@ -4992,7 +5192,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->curComponent:Landroid/content/ComponentName;
 
@@ -5006,7 +5206,7 @@
 
     move-result-object v5
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->intent:Landroid/content/Intent;
 
@@ -5024,23 +5224,23 @@
 
     move-object/from16 v0, p0
 
-    move-object/from16 v1, v32
+    move-object/from16 v1, v33
 
     invoke-virtual {v0, v1}, Lcom/android/server/am/BroadcastQueue;->logBroadcastReceiverDiscardLocked(Lcom/android/server/am/BroadcastRecord;)V
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget v5, v0, Lcom/android/server/am/BroadcastRecord;->resultCode:I
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v6, v0, Lcom/android/server/am/BroadcastRecord;->resultData:Ljava/lang/String;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-object v7, v0, Lcom/android/server/am/BroadcastRecord;->resultExtras:Landroid/os/Bundle;
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iget-boolean v8, v0, Lcom/android/server/am/BroadcastRecord;->resultAbort:Z
 
@@ -5048,7 +5248,7 @@
 
     move-object/from16 v3, p0
 
-    move-object/from16 v4, v32
+    move-object/from16 v4, v33
 
     invoke-virtual/range {v3 .. v9}, Lcom/android/server/am/BroadcastQueue;->finishReceiverLocked(Lcom/android/server/am/BroadcastRecord;ILjava/lang/String;Landroid/os/Bundle;ZZ)Z
 
@@ -5056,42 +5256,42 @@
 
     const/4 v3, 0x0
 
-    move-object/from16 v0, v32
+    move-object/from16 v0, v33
 
     iput v3, v0, Lcom/android/server/am/BroadcastRecord;->state:I
 
-    monitor-exit v38
+    monitor-exit v39
 
     goto/16 :goto_a6
 
-    :cond_810
+    :cond_862
     const/4 v10, 0x0
 
-    goto/16 :goto_73d
+    goto/16 :goto_78f
 
-    :cond_813
-    move-object/from16 v0, v32
+    :cond_865
+    move-object/from16 v0, v33
 
     move-object/from16 v1, p0
 
     iput-object v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcast:Lcom/android/server/am/BroadcastRecord;
 
-    move/from16 v0, v33
+    move/from16 v0, v34
 
     move-object/from16 v1, p0
 
     iput v0, v1, Lcom/android/server/am/BroadcastQueue;->mPendingBroadcastRecvIndex:I
 
-    monitor-exit v38
-    :try_end_820
-    .catchall {:try_start_69f .. :try_end_820} :catchall_74
+    monitor-exit v39
+    :try_end_872
+    .catchall {:try_start_6f1 .. :try_end_872} :catchall_74
 
     goto/16 :goto_a6
 
-    :catch_822
+    :catch_874
     move-exception v3
 
-    goto/16 :goto_672
+    goto/16 :goto_6c4
 .end method
 
 .method public final replaceOrderedBroadcastLocked(Lcom/android/server/am/BroadcastRecord;)Z
